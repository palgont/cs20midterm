<!DOCTYPE html>
<html>
    <head>
        <!-- URL: http://localhost:5500/midterm/index.html -->
        <title>Rent Housing</title>
        <!-- Link to external style sheet -->
        <link rel="stylesheet" href="styles.css">
        <!-- For JQuery usage -->
        <script src="https://code.jquery.com/jquery-3.6.0.min.js" 
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" 
        crossorigin="anonymous"></script>
        <!--Font Styles-->
        <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,
        wght@0,300..800;1,300..800&display=swap"
        rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Text:ital@0;1&display=swap"
        rel="stylesheet">
        <!-- For responsiveness -->
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <style>

            #land_note{ 
                position: relative;
                display: flex;
                flex-direction: column;
                top: 180px;
                height: 100px;
                text-align: center;
                z-index: 0;
            }
            #land_note h1 { 
                color:  #50affd ;
                margin-bottom: 8px;
            }
            #land_note span { 
                font-size: 1.2em;
                margin-bottom: 20px;
            }

            #first { 
                display: flex;
            }

            #main { 
                border: 15px solid block;
                justify-content: center;
                width: 75%;
                margin: 142px  0px;
                margin-bottom: 250px;
            }


            #house_gllry{ 
                width:100%;
                display: flex;
                flex-wrap: wrap;
                padding: 10px 0px 0px 10px;
                box-sizing: border-box;
            
                /* border: 2px solid black; */
            }

            .imgDiv { 
                margin : 72px 0px 0px  20px ; 
                width : 380px; 
                height: 380px;
                justify-content: center;
                border: 2px solid  #50affd;
                border-radius: 5px;
                display: grid;
                flex-direction: column;
                padding: 10px;
                box-sizing: border-box;
                box-shadow: -5px -5px 20px #888888;
                /* margin: 72px 0px auto auto;  */

            }
            .img { 
                width: 350px;
                height: 300px;
                justify-content: center;
                margin: 0 auto;
                border-radius: 5px;
                
            }
            .info { 
                margin: 0 auto;
                width: 100%;
               
            }
            .price { 
                font-size: 1.5em;
            }

            .address{
                display: inline-block;
            }
            
           

            #sidebar { 
                /* background-color: yellow; */
                /* border: 2px solid black; */
                width: 25%;
                justify-content: center;
                text-align: center;  
                margin-bottom: 50px;  
                padding-bottom: 100px; 
                bottom: 50px;
                height: 700px;          
            }

            #in_sidebar{ 
                width: 20%;
                top: 326px;
                left: 20px;
                border: 2px solid #50affd;
                padding: 50px 10px;
                border-radius: 5px;
                transition: 0.2s ease;
                box-shadow: -5px -5px 10px #888888;
                position: fixed;
                bottom: 100px;
                
                
            }

            #in_sidebar:hover { 
                border: 2px solid #008cba;
            }

            #in_sidebar span{
                margin-left: 5
            }

            .input { 
                width: 90%; 
                height: 35px; 
                margin: 10px 10px;
                border-radius: 5px;
                border: 1px solid #ccc;
                padding: 3px;
            }
            #min_p, #max_p{ 
                width: 30%;
                display: inline-block;
                height: 35px; 
                margin: 20px 10px;
                border-radius: 5px;
                padding: 3px;
                border: 1px solid #ccc;
                left: 10px;
                
            }
            #rntl_prd { 
                width: 90%;
                height: 35px ;
                margin: 20px 0;
                border-radius: 5px;
                border: 1px solid #ccc;
                color:  #ccc ;
            }

            #in_sidebar button { 
                width : 70px;
                color: white ;
                padding: 6px;
                border-radius: 5px;
                background-color: #50affd;
                border: none; 
                
                transition: 0.2s ease;
            }

            #in_sidebar button:hover { 
                background-color: #008cba;
                
            }
            footer{ 
                bottom : 0px ;
            }
            @media(max-width: 1075px ){ 
                .imgDiv { 
                    width : 345px; 
                    height: 345px;
                    margin: 72px 0px 0px 10px; 
                }
                .img { 
                    width: 315px;
                    height: 275px;                
                }

            }
           
            @media(max-width: 990px ){ 
                #sidebar { 
                    width: 40%;
                    margin: 0 auto;
                }

                #in_sidebar{ 
                    width : 32%; 
                }

                #main { 
                    width: 60%;
                    justify-content: center;
                }

            }

            @media (max-width: 640px) { 
                #first { 
                    flex-direction: column;
                }
                #sidebar{ 
                    width: 100%;
                    bottom: 0px;
                    height: 400px;
                    margin: 0 auto; 
                }
                #in_sidebar { 
                    position: relative;
                    width : 60%;
                    top : 250px;
                    bottom: 0px ;
                    left: 0;
                    margin: 0 auto;
                }

                #main { 
                    margin: 100px auto;
                    width : 100%
                }
                #house_gllry { 
                    margin: 50px auto;
                    width : 100%;
                    padding: 0px;
                }

                .imgDiv { 
                    width : 70%; 
                    height: 15%;
                    margin: 15px auto; 
                }
                .img { 
                    width: 95%;
                    height: 90%;                
                }

              
            }

            @media (max-width: 490px) { 

                #land_note span { 
                    font-size: 1em;
                    margin-bottom: 20px;
                }

                #land_note h1{ 
                    margin-top: 60px;
                    font-size: 30px;
                    margin-bottom: 10px;
                }
            }

            
            @media (max-width: 405px) { 
                #land_note span { 
                    font-size: 1em;
                    margin-bottom: 30px;
                    width: 250px;
                    text-align: center;
                    margin: 0 auto;
                }

                #land_note h1{ 
                    margin-top: 60px;
                    font-size: 22px;
                    margin-bottom: 10px;
                }

                #in_sidebar { 
                    margin-top: 30px;
                }
            }
        </style>        
    </head>
    <body>
     

        <!-- Header -->
        <div id="top_bar">
            <header>
                <a href="index.html">
                    <div id = "img_container">
                        <img id="logo" src="./images/house_logo.png">
                    </div>
                </a>
                <span id="title">PropertyPath</span>
            </header>
            <!-- Navagation Bar -->
            <nav>
                <a href="index.html">Home </a>
                <a href="buy.html">Buy </a>
                <a href="rent.html">Rent</a>
                <a href="sell.html">Sell</a>
                <a href="agents.html">Agents</a>
                <a href="qanda.html">Q/A</a>
                <a href="contact.html">Contact Us</a>
            </nav>
            <div id = "below_nav"></div>
        </div>

        <section id="land_note">
            <h1> Welcome to our Rent page! </h1>   
            <span>Please fill the form on the side to search for a 
                house
            </span> 
        </section>
        <section id="first">
                <div id="sidebar">
                    <div id="in_sidebar">
                        <span>Price Range:</span> <br/>
                        <input type="text" placeholder="Min price" id="min_p">
                        <input type="text" placeholder="Max price" id="max_p">
                        <input type="text" placeholder="# Bedrooms" class="input" id="num_bdrms">
                        <!-- <input type="text" placeholder="# Stories" class="input" id="num_stories"> -->
                        <input type="text" placeholder="Location" class="input" id="location">
                        <button id="search" class="input" >Search</button>
                    
                        <!-- We probablly want to call an API for location -->

                    </div>

                </div>
                
                <div id="main">     
                </div>
        </section>
        <script>
            $(document).ready(function(){ 
                fetch('./house_data.json')
                .then (response => response.json())
                .then (data => {
                    displayHouses(data.houses);
                    $("#search").on("click", function(){ 
                        search(data.houses); 
                    });
                })
                .catch (error => console.log(error))
        
                function displayHouses(houses) {  
                    var count_rent = 0 
                    console.log(count_rent)  
                    genDiv = $("<div>").attr("id", "house_gllry")             
                    for (var i = 0; i < (Math.ceil(houses.length)); i++) {                                                             
                        if(houses[i].sellOrRent == "rent") { 
                            //Create Image div                          
                            var newImgDiv = [ 
                                " <div class = 'imgDiv' id  = 'imgDiv" + i + "' > " + 
                                    "<img src = "+ houses[i].image +" class = 'img'  id = 'img"+ i + "' >" + 

                                    "<div class = 'info'>" + 
                                    "<span class = 'price'> $"+ houses[i].price + "/mo</span>"
                                    + "<br/>" +
                                    "<span class = 'address'>"+ houses[i].address.street + " " + 
                                    houses[i].address.city + " " + houses[i].address.state + "</span>"
                                    + "</div>"

                                + "</div>"
                            ]

                            //Add image_div to genDiv
                            genDiv.append(newImgDiv);
                            genDiv.append("    ");
                            }    
                    } 
                    //Add genDiv to page 
                    $("#main").append(genDiv)                    
                    console.log($("#main").html());                      
                }
                // <!-- Search Functionality -->


                function search(houses) { 
                    var min_price = $("#min_p").val(); 
                    var max_price = $("#max_p").val();
                    var num_bdrms = $("#num_bdrms").val();
                    var location = $("#location").val();
                    console.log("here")
                    console.log(min_price)

                    for (var i = 0; i < houses.length; i++) { 
                        if ((houses[i].sellOrRent == "rent") && 
                            // (houses[i].price >= min_price) && 
                            // (houses[i].price <= max_price) && 
                            // (houses[i].bedrooms == num_bdrms) &&
                            (location !== "" && (houses[i].address.city == location || 
                             houses[i].address.state == location || 
                             houses[i].address.street == location || 
                             houses[i].address.zip == location)) &&
                            (min_price !== "" && houses[i].price >= min_price) &&
                            (max_price !== "" && houses[i].price <= max_price) &&
                            (num_bdrms !== "" && houses[i].bedrooms == num_bdrms)) {

                            console.log("Right in if")
                            $("#imgDiv" + i).css({"display":"block"});
                            console.log(houses[i].price)
                            console.log(min_price)
                        } else { 
                            console.log("Right in else")
                            $("#imgDiv" + i).css({"display":"none"});
                        }
                        // console.log("Right in if")

                    }
                    console.log(min_price,max_price,num_bdrms,location );
                }
                    
            })
        </script>

        <!-- Footer -->
        <footer>
            <p>PropertyPath &nbsp;|&nbsp;+1(###)-###-#### &nbsp;| 
                &nbsp; <a href="mailto:propertypath@gmail.com">
                    propertypath@gmail.com</a></p>
        </footer>
    </body>
</html>